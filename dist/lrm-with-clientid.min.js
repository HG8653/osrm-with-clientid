/*! osrm-with-clientid - v1.0.0 - 2015-09-15 */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(b.L||(b.L={})).Routing=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b,c){function d(a){return a>=200&&300>a||304===a}function e(){void 0===h.status||d(h.status)?b.call(h,null,h):b.call(h,h,null)}var f=!1;if("undefined"==typeof window.XMLHttpRequest)return b(Error("Browser not supported"));if("undefined"==typeof c){var g=a.match(/^\s*https?:\/\/[^\/]*/);c=g&&g[0]!==location.protocol+"//"+location.domain+(location.port?":"+location.port:"")}var h=new window.XMLHttpRequest;if(c&&!("withCredentials"in h)){h=new window.XDomainRequest;var i=b;b=function(){if(f)i.apply(this,arguments);else{var a=this,b=arguments;setTimeout(function(){i.apply(a,b)},0)}}}return"onload"in h?h.onload=e:h.onreadystatechange=function(){4===h.readyState&&e()},h.onerror=function(a){b.call(this,a||!0,null),b=function(){}},h.onprogress=function(){},h.ontimeout=function(a){b.call(this,a,null),b=function(){}},h.onabort=function(a){b.call(this,a,null),b=function(){}},h.open("GET",a,!0),h.send(null),f=!0,h}"undefined"!=typeof b&&(b.exports=d)},{}],2:[function(a,b,c){function d(a,b){a=Math.round(a*b),a<<=1,0>a&&(a=~a);for(var c="";a>=32;)c+=String.fromCharCode((32|31&a)+63),a>>=5;return c+=String.fromCharCode(a+63)}var e={};e.decode=function(a,b){for(var c,d,e=0,f=0,g=0,h=[],i=0,j=0,k=null,l=Math.pow(10,b||5);e<a.length;){k=null,i=0,j=0;do k=a.charCodeAt(e++)-63,j|=(31&k)<<i,i+=5;while(k>=32);c=1&j?~(j>>1):j>>1,i=j=0;do k=a.charCodeAt(e++)-63,j|=(31&k)<<i,i+=5;while(k>=32);d=1&j?~(j>>1):j>>1,f+=c,g+=d,h.push([f/l,g/l])}return h},e.encode=function(a,b){if(!a.length)return"";for(var c=Math.pow(10,b||5),e=d(a[0][0],c)+d(a[0][1],c),f=1;f<a.length;f++){var g=a[f],h=a[f-1];e+=d(g[0]-h[0],c),e+=d(g[1]-h[1],c)}return e},void 0!==typeof b&&(b.exports=e)},{}],3:[function(a,b,c){(function(c){!function(){"use strict";var d="undefined"!=typeof window?window.L:"undefined"!=typeof c?c.L:null,e=a("corslite"),f=a("polyline");d.Routing=d.Routing||{},d.Routing.OSRMwithCid=d.Class.extend({options:{serviceUrl:"//localhost/viaroute",timeout:3e4},initialize:function(a,b){d.Util.setOptions(this,b),this._hints={locations:{}},this._client_id=a},route:function(a,b,c,f){var g,h,i,j,k=!1,l=[];for(f=f||{},g=this.buildRouteUrl(a,f),h=setTimeout(function(){k=!0,b.call(c||b,{status:-1,message:"OSRM request timed out."})},this.options.timeout),j=0;j<a.length;j++)i=a[j],l.push(new d.Routing.Waypoint(i.latLng,i.name,i.options));return e(g,d.bind(function(a,d){var e;clearTimeout(h),k||(a?b.call(c||b,{status:-1,message:"HTTP request failed: "+a}):(e=JSON.parse(d.responseText),this._routeDone(e,l,b,c)))},this)),this},_routeDone:function(a,b,c,d){var e,f,g,h;if(d=d||c,0!==a.status)return void c.call(d,{status:a.status,message:a.status_message});if(e=this._decodePolyline(a.route_geometry),g=this._toWaypoints(b,a.via_points),f=[{name:this._createName(a.route_name),coordinates:e,instructions:a.route_instructions?this._convertInstructions(a.route_instructions):[],summary:a.route_summary?this._convertSummary(a.route_summary):[],inputWaypoints:b,waypoints:g,waypointIndices:this._clampIndices(a.via_indices,e)}],a.alternative_geometries)for(h=0;h<a.alternative_geometries.length;h++)e=this._decodePolyline(a.alternative_geometries[h]),f.push({name:this._createName(a.alternative_names[h]),coordinates:e,instructions:a.alternative_instructions[h]?this._convertInstructions(a.alternative_instructions[h]):[],summary:a.alternative_summaries[h]?this._convertSummary(a.alternative_summaries[h]):[],inputWaypoints:b,waypoints:g,waypointIndices:this._clampIndices(1===a.alternative_geometries.length?a.alternative_indices:a.alternative_indices[h],e)});a.hint_data&&this._saveHintData(a.hint_data,b),c.call(d,null,f)},_decodePolyline:function(a){var b,c=f.decode(a,6),e=[];for(b=0;b<c.length;b++)e.push(d.latLng(c[b]));return e},_toWaypoints:function(a,b){var c,e=[];for(c=0;c<b.length;c++)e.push(d.Routing.waypoint(d.latLng(b[c]),a[c].name,a[c].options));return e},_createName:function(a){var b,c="";for(b=0;b<a.length;b++)a[b]&&(c&&(c+=", "),c+=a[b].charAt(0).toUpperCase()+a[b].slice(1));return c},buildRouteUrl:function(a,b){for(var c,d,e,f,g,h=[],i=0;i<a.length;i++)c=a[i],f=this._locationKey(c.latLng),h.push("loc="+f),g=this._hints.locations[f],g&&h.push("hint="+g),c.options&&c.options.allowUTurn&&h.push("u=true");return e=d=!(b&&b.geometryOnly),this.options.serviceUrl+"?instructions="+d.toString()+"&alt="+e.toString()+"&"+(b.z?"z="+b.z+"&":"")+h.join("&")+(void 0!==this._hints.checksum?"&checksum="+this._hints.checksum:"")+(b.fileformat?"&output="+b.fileformat:"")+(b.allowUTurns?"&uturns="+b.allowUTurns:"")+"&client_id="+this._client_id},_locationKey:function(a){return a.lat+","+a.lng},_saveHintData:function(a,b){var c;this._hints={checksum:a.checksum,locations:{}};for(var d=a.locations.length-1;d>=0;d--)c=b[d].latLng,this._hints.locations[this._locationKey(c)]=a.locations[d]},_convertSummary:function(a){return{totalDistance:a.total_distance,totalTime:a.total_time}},_convertInstructions:function(a){var b,c,d,e,f=[];for(b=0;b<a.length;b++)c=a[b],d=this._drivingDirectionType(c[0]),e=c[0].split("-"),d&&f.push({type:d,distance:c[2],time:c[4],road:c[1],direction:c[6],exit:e.length>1?e[1]:void 0,index:c[3]});return f},_drivingDirectionType:function(a){switch(parseInt(a,10)){case 1:return"Straight";case 2:return"SlightRight";case 3:return"Right";case 4:return"SharpRight";case 5:return"TurnAround";case 6:return"SharpLeft";case 7:return"Left";case 8:return"SlightLeft";case 9:return"WaypointReached";case 10:return"Straight";case 11:case 12:return"Roundabout";case 15:return"DestinationReached";default:return null}},_clampIndices:function(a,b){var c,d=b.length-1;for(c=0;c<a.length;c++)a[c]=Math.min(d,Math.max(a[c],0))}}),d.Routing.osrm=function(a,b){return new d.Routing.OSRMwithCid(a,b)},b.exports=d.Routing}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{corslite:1,polyline:2}]},{},[3])(3)});